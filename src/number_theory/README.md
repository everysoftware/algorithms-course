## Теория чисел

Код: `number_theory`

### Теория чисел

Теория чисел - раздел математики, изучающий целые числа и их свойства. Основные понятия теории чисел:

- Делители числа
- Простые числа
- Наибольший общий делитель
- Наименьшее общее кратное
- Теорема Эйлера
- Теорема Ферма
- Китайская теорема об остатках

### Поиск делителей

Делитель числа - это число, на которое данное число делится без остатка. Делители числа можно найти перебором всех чисел
от 1 до корня из числа.

Почему не обязательно перебирать все числа до самого числа? Потому что если число делится нацело на какое-то число `a`,
то оно также делится нацело на число `b = n / a`. Поэтому достаточно перебирать числа до корня из числа.

Получается, что делители числа идут парами: `a` и `b = n / a`. Если `a = b`, то это корень из числа. Например:

- Делители числа 10: 1, 2, 5, 10
- Делители числа 16: 1, 2, 4, 8, 16
- Делители числа 25: 1, 5, 25
- Делители числа 36: 1, 2, 3, 4, 6, 9, 12, 18, 36

### Простые числа

Простое число - это натуральное число, большее 1, которое делится без остатка только на 1 и на само себя. Простые числа
первые в списке всех натуральных чисел.

Простые числа: 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, ...

### Наибольший общий делитель

Наибольший общий делитель (НОД) двух чисел - это наибольшее число, на которое оба числа делятся без остатка.
НОД двух чисел можно найти с помощью алгоритма Евклида. Алгоритм Евклида основан на следующем свойстве.
Пусть a и b - два целых числа, и r - остаток от деления a на b, тогда `НОД(a, b) = НОД(b, r)`.

**Доказательство свойства общего делителя:** Число a представляется как: `a = bq + r`, где `q = a div b` и
`r = a mod b`. Пусть `d = НОД(a, b)`, тогда `a = dx` и `b = dy` для некоторых целых x и y. Распишем остаток:
`r = a - bq = dx - dyq = d(x - yq)`. Таким образом, d - общий делитель a, b и r.

**Доказательство свойства максимальности:**
Предположим, что существует число `e > d`, которое является общим делителем b и r.
Тогда e должно быть делителем a, так как `a = bq + r`.
Однако это противоречит определению d как НОД(a, b).

Сложность алгоритма Евклида составляет `O(log(min(a, b)))`. В алгоритме Евклида на каждом шаге мы заменяем пару чисел
(a, b) на пару (b, a mod b). Для анализа сложности давайте воспользуемся свойством остатков:
если `a > b`, то `a mod b < a / 2`. Это означает, что на каждом шаге хотя бы одно из наших чисел
уменьшается минимум вдвое, что и дает оценку `O(log(min(a, b)))`. Случай `a <= b` аналогичен случаю `a > b`, так как на
следующем шаге мы поменяем местами a и b.

Доказательство свойства остатков: если `a > b`, то `a mod b < a / 2`. Пусть `a = bq + r`, тогда
`r = a - bq < a - b` (так как `q > 1`). С другой стороны, `0 <= r < b`. Давайте сложим оба неравенства:
`r + r < a - b + b`, то есть `2r < a`, следовательно, `r < a / 2`.

### Задачи

| Задача                                   | Код               |
|------------------------------------------|-------------------|
| Поиск делителей                          | `divisors`        |
| Проверка на простоту                     | `is_prime`        |
| Наибольший общий делитель                | `gcd`             |
| Решето Эратосфена                        | `sieve`           |
| Тесты на простоту Ферма и Миллера-Рабина | `primality_tests` |
| RSA-шифрование                           | `rsa`             |